import crypto from 'crypto'

export const privateKey = `-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-256-CBC,C358C79878282DE24CD99FDCF9A51162

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
-----END RSA PRIVATE KEY-----`

const decryptParams = (encryptedParams) => {
    var buffer = Buffer.from(encryptedParams, "base64")
    var decrypted = crypto.privateDecrypt(
        {
            key: privateKey, 
            passphrase: 'lamboclubFrontendDevelopment'
        }, 
        buffer)
    return decrypted.toString("utf8")
}

const decryption = (req, res, next) => {
    if(req.body.params) {
        req.body = JSON.parse(decryptParams(req.body.params))
    }
        
    next()
}

export default decryption